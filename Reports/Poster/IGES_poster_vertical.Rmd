---
main_topsize: 0.1 #percent coverage of the poster
main_bottomsize: 0.05
#ESSENTIALS
title: Polymethylation Scores for Prenatal Maternal Smoke Exposure Persist Until Age
  15 and Are Detected in Saliva
title_textsize: 100
author:
- name: Freida Blostein
  affil: 1
  twitter: blostein
  email: blostein@umich.edu
  orcid: 0000-0002-1099-3857
  main: yes
- name: Jonah Fisher
  affil: 2
- name: John Dou
  affil: 1
- name: Lisa Schenper
  affil: 3
- name: Daniel A. Notterman
  affil: 3
- name: Colter Mitchell
  affil: 2
- name: Kelly M. Bakulski
  affil: 1
affiliation:
- num: 1
  address: Department of Epidemiology, University of Michigan School of Public Health,
    Ann Arbor, Michigan, USA
- num: 2
  address: Institute for Social Research, University of Michigan, Ann Arbor, Michigan,
    USA
- num: 3
  address: Department of Molecular Biology, Princeton University, Princeton, New Jersey,
    USA
main_findings:
  - "**Polymethylation scores** for prenatal maternal smoke exposure **persist over time** and are **robust across ancestries**"
logoleft_name: 'Images/Epid_informal_horiz_white.png'
logoright_name: 'Images/Fragile_Families_Logo.png'
logocenter_name: https&#58;//raw.githubusercontent.com/brentthorne/posterdown/master/images/qr-code-black.png
primary_colour: "#0048A4"
secondary_colour: "#5885AF"
accent_colour: "#E35A01"
output: 
  posterdown::posterdown_betterport:
    self_contained: false
    pandoc_args: --mathjax
    number_sections: false
bibliography: "Methylation_SmokingBib.bib"
link-citations: true
---

```{=html}
<style>
#main-img-left {
 width: 20%
}
#main-img-center {
 width: 2%
}
#main-img-right {
width=20%
}
.mybreak {
   break-before: column;
}
</style>
```


```{r, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      warning = FALSE,
                      tidy = FALSE,
                      message = FALSE,
                      fig.align = 'center',
                      out.width = "100%")
options(knitr.table.format = "html") 
mydir="/nfs/turbo/bakulski1/People/blostein/FF_methylation/Code/Reports/Poster"
codedir="/nfs/turbo/bakulski1/People/blostein/FF_methylation/Code/"
imagedir=paste0(mydir, "/Images/")
setwd(mydir)
```

# Introduction

Prenatal maternal smoking is associated with DNA methylation in children [@Joubert:2016ue]. Thus, summary metrics of DNA methylation could serve as reliable and specific biomarkers of prenatal smoke exposure.

```{r, joubertfigure, fig.cap='Volcano plot showing associations between CpG methylation in cord blood and prenatal maternal smoking exposure in @Joubert:2016ue'}
knitr::include_graphics('Images/Joubert_volcano.jpeg')
```


***But some gaps remain...!***

1.  ![](Images/Icons/noun_blood%20sample_4011680.svg) **Tissue:** Previous studies have measured methylation in peripheral or cord blood. **Are the same methylation markers of prenatal maternal smoking also present in saliva, an easier to collect sample?**

2.  ![](Images/Icons/noun_ethnicity_94199.svg) **Ancestry:** Previous study populations have been of European descent. **Are methylation markers of prenatal maternal smoking consistent across different ancestry groups?**

3.  ![](Images/Icons/noun_Life%20Stages_398930.svg) **Time:** Previous study populations have examined methylation at a single cross-sectional time point in infancy or early childhood. **Are methylation markers of prenatal maternal smoking persistent as children age?**

***We tested the association between prenatal maternal smoking and DNA methylation summary measures in sequential saliva samples from a diverse-ancestry, longitudinal birth cohort***



# Methods {.mybreak}

The **Fragile Families and Child Wellbeing study** is a *longitudinal* cohort of US children followed from birth until 22 years of age.

-   *Smoking during pregnancy*: Maternal interview at birth.

-   *Methylation*: Saliva samples from 9 and 15 year visit; 450K chip.

-   *Covariates*: Maternal alcohol and drug use during pregnancy (birth interview), income-to-poverty ratio (birth), maternal postnatal smoking (interviews), child smoking (interviews), child's genetic ancestry categorization (principal components of genetic data), cell type proportions (estimated from methylation data)

```{r, FFfigure, fig.cap='Study design and timeline of exposure, outcome and covariate assessment in the Fragile Families and Child Wellbeing cohort'}
knitr::include_graphics('Images/FF_studydesign.png')
```

## Methylation summary measures

We used several common summary measures of methylation data, including global methylation and methylation clocks. We also created several prenatal maternal smoking specific polymethylation scores, using regression coefficients from @Joubert:2016ue.

**Polymethylation scores**

For $i$ individuals with $j$ CpG sites measured:

$$
Score_i=\sum \color{darkgreen} {\beta_{regression_{j}}} *  \color{darkblue} {t(B_{CpG_{ij}})}
$$ 

[Regression coefficients for CpG sites from a previous epigenome wide association analysis]{style="color: darkgreen;"}<sup>a</sup> are used to weight [each individual's methylation beta value at that CpG site]{style="color: darkblue;"}<sup>b</sup>. These weighted methylation values are summed across all CpG sites.

```{=html}
<div style="line-height: 1em; margin-bottom:5px;">

<span style="color: darkgreen; font-size:18px"><sup>a</sup>We benchmarked 4 different regression coefficients made available in @</span>

<span style="color: darkblue; font-size:18px"><sup>b</sup>Methylation beta values are continuous and bounded at $[0, 1]$. Concerned this might upweight the importance of highly methylated probes, we benchmarked 3 different transformations (t()) of methylation beta values: no transform, mean-centered and z-score.</span>

</div>
```

 
# Results 

```{r data read and set up}
source(paste0(codedir, 'Scripts/', '03_summary_methyl_models.R'))
```

**Methylation summary metrics by prenatal maternal smoking and child age**

Table \@table1 shows the distributions of methylation summary measures ancestry (inferred from ellipses of genetic principal components) by prenatal maternal smoke exposure (yes=exposed, no=unexposed) and visit (C=age 9 visit, T=age 15 visit). 

```{r, table1}
export2md(strataTable(createTable(compareGroups(smkPreg_binary~globalmethylation+pediatric+SSnewbornCT_center+ancestry, data=modeldata)), 'childteen'))
```

## Polymethylation scores are correlated and stable between age 9 and age 15

```{r}
outcome_labels=c('Global methylation', 'Pediatric clock', 'Polymethylation score \n (newborn, mean centered)')
names(outcome_labels)=c('globalmethylation', 'pediatric', 'SSnewbornCT_center')

modeldata%>%dplyr::select(idnum, childteen, SSnewbornCT_center, globalmethylation, pediatric)%>%pivot_longer(cols=c(globalmethylation, pediatric, SSnewbornCT_center), names_to='Methylation summary measure type', values_to='Methylation summary measure')%>%pivot_wider(names_from=childteen, values_from=`Methylation summary measure`)%>%mutate(meth_f=factor(`Methylation summary measure type`, levels=c('SSnewbornCT_center', 'globalmethylation', 'pediatric')))%>%ggplot(aes(x=C, y=T))+geom_point()+stat_cor()+geom_smooth(method=lm)+theme_classic()+scale_x_continuous('Age 9 score')+scale_y_continuous('Age 15 score')+facet_wrap(~meth_f, scales='free', labeller = labeller(meth_f=outcome_labels))+theme(text=element_text(size=16))


```

```{r}
modeldata %>%group_by(idnum)%>%filter(n()>1)%>%pivot_longer(cols=c('globalmethylation', 'pediatric', 'SSnewbornCT_center'), names_to='measuretype', values_to='Methylation summary measure')%>%group_by(measuretype, idnum) %>%
    mutate(slope = (`Methylation summary measure`[childteen=='T'] - `Methylation summary measure`[childteen=='C'])/(2-1))%>%filter(!is.na(`Methylation summary measure`))%>%
  ggplot(aes(x=childteen, y=`Methylation summary measure`, group=idnum))+geom_point()+geom_line(alpha=0.1, aes(color=slope>0))+geom_smooth(aes(group=1), method='lm', fill='blue')+facet_wrap(~measuretype, scales='free_y', labeller = labeller(measuretype=outcome_labels))+theme_classic()+scale_x_discrete('', labels=c('Age 9', 'Age 15'))+scale_color_manual(name='', labels=c('slope<0', 'slope>0'), values=c('blue', 'red'))


modeldata %>%group_by(idnum)%>%filter(n()>1)%>%pivot_longer(cols=c('globalmethylation', 'pediatric', 'SSnewbornCT_center'), names_to='measuretype', values_to='Methylation summary measure')%>%group_by(measuretype, idnum) %>%
    mutate(slope = (`Methylation summary measure`[childteen=='T'] - `Methylation summary measure`[childteen=='C'])/(2-1), slope_factor=case_when(slope>0~'Positive', slope<=0~'Negative'))%>%filter(!is.na(`Methylation summary measure`))%>%ggplot(aes(x=slope))+geom_histogram()+geom_blank(aes(x=-slope)) + facet_wrap(~measuretype, scales='free', ncol=1)
```

## Polymethylation scores are a specific, persistant and consistent marker of prenatal maternal smoke exposure

```{r, forestplot, fig.cap='Forest plot from ancestry-specific regressions of prenatal maternal smoking against various methylation summary metrics. All models control for child sex, mother income to poverty ratio at birth, epithelial and immune cell proportions (estimated from methylation data), maternal other drug and other alcohol use during pregnancy, batch, genetic ancestry (1st two principal components of genetic data), postnatal smoke exposure (any postnatal maternal smoking and maternal packs per day in month prior to visit) ', out.width="80%"}
my_outcomes=c('Global methylation', 'Pediatric clock', 'Sustained smoking polymethylation score (newborns, cell-type controlled)')

all_models=rbind(local_models, global_models%>%mutate(ancestry='Unstratified'))

data_text=all_models%>%
  mutate(n=map_dbl(data, nrow), n=paste0('n=', n), x=-0.25)%>%
  unnest(tidied)%>%
  filter(outcome=='Sustained smoking polymethylation score (newborns, cell-type controlled)' & term=='smkPreg_binaryYes'& predictors=='secondhand smoke exposure model')%>%mutate(outcome_f=outcome)
  
names(outcome_labels)=my_outcomes
all_models%>%
  mutate(n=map_dbl(data, nrow), n=paste0('n=', n))%>%
  unnest(tidied)%>%
  filter(term=='smkPreg_binaryYes' & predictors=='secondhand smoke exposure model')%>%
  filter(outcome%in% my_outcomes)%>%
    mutate(outcome_f=factor(outcome, levels=rev(my_outcomes)))%>%
  ggplot(aes(x=estimate, xmin=conf.low, xmax=conf.high, color=factor(age, rev(levels(age))), y=ancestry))+
  geom_point(position = position_dodge(width = 1))+
  geom_errorbarh(height=0.1, position = position_dodge(width = 1))+
  facet_grid(.~outcome_f, scales='free_x', labeller = labeller(outcome_f=outcome_labels))+
  geom_vline(xintercept=0, color='red', linetype="dashed", alpha=0.5)+
  geom_text(data=data_text, aes(x=x,label=n), position=position_dodge(width = 1), hjust=0.05)+
  theme_classic()+
  theme(text = element_text(size=16))+theme(legend.position = 'bottom')+
  scale_color_discrete('', limits=c('Age 9', 'Age 15'))+
  scale_x_continuous('Coefficient for prenatal maternal smoking + 95% CI')+
  scale_y_discrete('', limits=c('European ancestry', 'Hispanic ancestry', 'African ancestry', 'Unstratified'))+scale_color_manual('', values=c('black', 'darkgrey'))

```

# Conclusions

# References


