---
title: "Polymethylation scores results"
author: "F blostein"
date: "9/30/2021"
output:
  html_document:
    code_folding: show
    highlight: tango
    number_sections: no
    theme: sandstone
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(message=FALSE)

library(ggplot2)
library(kableExtra)
library(ggpubr)
library(tidyr)
library(stringr)
library(dplyr)
library(compareGroups)
library(kableExtra)
library(haven)
library(sjlabelled)
library(matchmaker)
library(EpiDISH)
library("PerformanceAnalytics")
library(DescTools)
library(purrr)
library(broom)
library(broom.mixed)
library(ggplot2)
library(multcomp)
library(ggpubr)
library(cowplot)
library(geepack)
library(lme4)
library(pROC)
library(lmerTest)
library(stringr)
library(sva)
```

```{r temp read n data}
codedir=''
datadir="/nfs/turbo/bakulski1/People/blostein/FF_methylation/Data"
load(paste0(datadir, '/CreatedData/allPhenoData.Rdata'))
load(paste0(datadir, '/CreatedData/allmethyl.Rdata'))
load(paste0(datadir, '/CreatedData/completeCasemethyl.Rdata'))
```

```{r future run scripts, cache=T}

source('/nfs/turbo/bakulski1/People/blostein/FF_methylation/Code/Scripts/03_summary_methyl_models.R')
```

```{r plotting variables}
theme_set(theme_classic())
```

```{r}
n_total=modeldata %>% dplyr::select(id)%>%unique()%>%nrow()
n_obs=modeldata%>%nrow()


my_round=function(x, d){
  y=c()
  d_orig=d
  for(i in 1:length(x)){
    d=d_orig
    while(round(x[i], d)==0){
    d=d+1
    }
    y[i]=round(x[i], d)
  }
  return(y)
}
```

# Current issues


    
# Target journal and deadline 

[Clinical epigenetics](https://www.biomedcentral.com/collections/epibio): Special issue on biomarkers; due date December 1st
 >Epigenetic biomarkers have significantly contributed to improved understanding of the origins and progression of disease.  Moreover, increasing evidence shows that epigenetic biomarkers have potential for personalized medicine. However, routine use of epigenetic biomarkers in in-vitro diagnostics (IVD) is lagging behind the discoveries of new biomarkers. In this thematic series of Clinical Epigenetics, we discuss current progress in development of epigenetic biomarkers for clinical use in common complex diseases of ageing and welcome both original research and reviews.
The sections of the collection include:
  - Types of epigenetic biomarkers and readiness for IVD use
    - DNA methylation as biomarker
    - Histone modification as biomarker
    - Upcoming field of circulating free nucleosomes as biomarker
    - Progress towards clinical use of biomarker
  - *Biomarkers of environmental exposures and causality of the biomarker*
  - Disease predisposition biomarkers
  - Biomarkers used for disease detection
  - Clinical disease prevention and management: predictive and prognostic
  - Monitoring of chronic disease
  - *Single versus multiple biomarkers and risk scores*
  - Major stages of clinical validation of the biomarker
  - Biomarker detection technologies suitable for IVD use and significance of bioinformatics
  - Ethics and regulatory aspects of IVD epigenetic biomarkers

# Figure 1 - CONSORT Diagram

```{r, eval=T}
#Make Labels
n_fullFF<-paste0("Fragile Families cohort \n", "n=", FF_labeled %>% nrow())
n_methylQC<-paste0("Cohort with 450K methylation data \n", "n=", methylCohort$idnum%>%unique()%>%length(), " individuals with m=", methylCohort$MethID%>%length(), " samples")

n_QCloss<-paste0("Methylation data QC: ", 
                 pdqc_all%>%filter(probe_fail_10==T & childteen!='M')%>%nrow(), " samples / ", 
                 pdqc_all%>%filter(probe_fail_10==T & childteen!='M')%>%dplyr::select(idnum)%>%unique()%>%nrow(), 
                 " individuals with >10% of probes failing dropped, \n",
                 pdqc_all%>%filter(sex_new!=predicted_sex & probe_fail_10==F & childteen!='M')%>%nrow(), " samples / ", 
                 pdqc_all%>%filter(sex_new!=predicted_sex & probe_fail_10==F & childteen!='M')%>%dplyr::select(idnum)%>%unique()%>%nrow(),
                 " individuals with discordant sex samples dropped, \n",
                 pdqc_all%>%filter(predicted_sex_outlier==T & sex_new==predicted_sex & probe_fail_10==F & childteen!='M')%>%nrow(), ' samples / ',
                  pdqc_all%>%filter(predicted_sex_outlier==T & sex_new==predicted_sex & probe_fail_10==F & childteen!='M')%>%dplyr::select(idnum)%>%unique()%>%nrow(), 
                  ' individuals with abnormal sex chromosome intensity dropped & \n',
                 length(reps_remove), " duplicate samples dropped")

n_methylFF<-paste0("Cohort with quality controlled 450K data \n","n=", myFF %>% dplyr::select(id) %>% unique() %>% nrow(), " individuals with m=", myFF%>%nrow(), " samples")

n_baseexclusions<-paste0("n individuals=",  
                         myFF %>% filter_at(all_of(basemodelvar), any_vars((. %in%c("Missing", "Missing PC data"))))%>% dplyr::select(id) %>% unique() %>% nrow(), " \ m samples=", 
                         myFF %>% filter_at(all_of(basemodelvar), any_vars((. %in%c("Missing", "Missing PC data")))) %>% nrow(), " missing principal components of ancestry; \n n individuals=",
                         myFF %>% filter_at(all_of(basemodelvar), any_vars((is.na(.))))%>%dplyr::select(id)%>%unique()%>%nrow(), " individuals \ m=", myFF %>% filter_at(all_of(basemodelvar), any_vars((is.na(.))))%>%nrow(), " samples missing child age at maternal/PCG interview")

n_prenatalexposures<-paste0("Prenatal exposures models: \n","n=", prenatalexdata %>% dplyr::select(id) %>% unique() %>% nrow(), " individuals with m=", prenatalexdata %>%nrow(), " samples")
n_prenatalexclusions<-paste0("n=", basemodeldata %>% filter_at(all_of(prenatalexposurevar), any_vars(. %in% c("Missing"))) %>% dplyr::select(id) %>% unique() %>% nrow(), " individuals & m=", basemodeldata %>% filter_at(all_of(prenatalexposurevar), any_vars(. %in% c("Missing"))) %>% nrow(), " samples missing \n data on maternal prenatal alcohol and drug use")

n_secondhandSmk<-paste0("Secondhand smoke exposure models: \n","n=", secondhandsmkdata %>% dplyr::select(id) %>% unique() %>% nrow(), " individuals with m=", secondhandsmkdata %>%nrow(), " samples")
n_secondhandexclusions<-paste0("n=", prenatalexdata$id[!(prenatalexdata$id %in% secondhandsmkdata$id)] %>% unique()%>% length(), " individuals & m=", prenatalexdata %>% filter_at(all_of(secondhandsmokevars), any_vars(. %in% c("Missing"))) %>% nrow(), " samples missing data \n on maternal or primary care giver postnatal smoking")

n_Child<-paste0('n=', secondhandsmkdata %>%filter(childteen=='C')  %>% nrow(), " individuals with a 9 year visit")
n_ChildSmkexcluded<-paste0("Exclude children who smoke: \n",'n=', child_nosmoke %>% nrow(), " individuals with a 9 year visit")
n_ChildSmkexclusions<-paste0('n=', child_smoke%>%nrow(), " individual \n smoking at 9 year visit \n or missing focal child smoking data")
n_Teen<-paste0('n=', secondhandsmkdata %>%filter(childteen=='T')   %>% nrow(), " individuals with a 15 year visit")
n_TeenSmkexcluded<-paste0("Exclude children who smoke: \n",'n=', teen_nosmoke %>% nrow(), " individuals with a 15 year visit")
n_TeenSmkexclusions<-paste0('n=', teen_smoke%>%nrow(), " individuals \n smoking at 15 year visit \n or missing focal child smoking data") 



graph1<-DiagrammeR::grViz("
   digraph graph2 {
   compound=true;
   graph [layout = dot]
   
   node [shape = rectangle, width=4]
   a [label = '@@1']
   b [label = '@@2']
   c [label = '@@3']
   d [label = '@@4']
   e [label = '@@5']
   f [label = '@@6']
   g [label = '@@7']
   h [label = '@@8']
   i [label = '@@9', group=g1]
   j [label = '@@10']
   k [label = '@@16']
   l [label = '@@17']
   m [label = '@@19']
   
   #fake nodes for connecting to edges
   node [shape=point, width=0.01, height=0.01]
   a1
   b1
   c1
   d1
#   e1
  f1 [group=g1]
  g1
  k1
   
  #exclusion nodes
  node [shape = rectangle, width=4]
  aa [label = '@@20']
  bb [label = '@@11']
  cc [label = '@@12']
  dd [label = '@@13']
  ff [label = '@@14', width=3]
  gg [label = '@@15', width=3]
  kk [label = '@@18', width=3]
    
  #draw connections
  a->m
  m->a1 [arrowhead=none]
  a1->b
  b->b1 [arrowhead=none]
  b1->c
  c->c1 [arrowhead=none]
  c1->d
  d->d1 [arrowhead=none]
  d1->e
  e->f; e->g; e->k
{rank=same; h->e [dir=back, minlen=2, style=dashed]}
  f->f1 [arrowhead=none]
  g->g1 [arrowhead=none]
  k->k1 [arrowhead=none]
  f1->i 
  g1->j 
  k1->l 
  
{rank=same; a1->aa [minlen=2]}   
{rank=same; b1->bb [minlen=2]} 
{rank=same; c1->cc [minlen=2]}
{rank=same; d1->dd [minlen=2]}
{rank=same; f1->ff [minlen=2]}
{rank=same; g1->gg [minlen=2]}
{rank=same; k1->kk [minlen=2]}

#invisible constraints to force ordering
ff->i [style=invis]
   }   
   
   [1]: n_fullFF
   [2]: n_methylFF
   [3]: n_basemodel
   [4]: n_prenatalexposures
   [5]: n_secondhandSmk
   [6]: n_Child
   [7]: n_Teen
   [8]: n_sensFatherSmoking
   [9]: n_ChildSmkexcluded
   [10]: n_TeenSmkexcluded
   [11]: n_baseexclusions
   [12]: n_prenatalexclusions
   [13]: n_secondhandexclusions
   [14]: n_ChildSmkexclusions
   [15]: n_TeenSmkexclusions
   [16]: n_twovisits
   [17]: n_twovisitsSmkExcluded
   [18]: n_twovisitSmkExclusions
   [19]: n_methylQC
   [20]: n_QCloss
")
```

# Supplemental Table 1 - Comparison of excluded sample to included sample

```{r}
myFF$MethylData2<-ifelse(myFF$MethID %in% completecase$MethID, 'Final analysis group', 'Not in final analysis group')
set_label(myFF$MethylData2)<-'Exclusions based on missing data'
myFF=left_join(myFF, methyldata%>%mutate(idnum=as.character(idnum)))
methyl2<-createTable(compareGroups(MethylData2~smkPreg_binary+globalmethylation+pediatric+Epithelial.cells_saliva+Leukocytes_saliva+anynewborn_center+SSnewbornCT_center+SSolder_center+cm1inpov+ancestry+cm1bsex+m1g2_YesNoPreg+m1g3_YesNoPreg+PostnatalMaternalSmokingAny+SmkAtVisitPastmonth, data=myFF), show.all=T)
export2md(strataTable(methyl2, 'childteen'), caption="Exclusion table of subset with quality controlled methylation data vs final analytic subset for main predictor, outcomes and key demographic variables")
```


# Supplemental Figure 2 - Correlation of methylation summary measures

```{r}
library(Hmisc)
library(corrplot)
res2<-completecase%>%dplyr::select(globalmethylation, pediatric, grim, Epithelial.cells_saliva, Leukocytes_saliva, anynewborn_center, SSnewbornCT_center, SSolder_center, cg05575921)%>%as.matrix(.)%>%rcorr()
corrplot.mixed(res2$r, upper="ellipse", lower='number', order='hclust')
```


#Supplemental Figure 3 - Change in methylation summary measures between visits

```{r}


```

# Figure 2: Polymethylation scores are correlated and stable between age 9 and age 15 in a diverse sample of `r n_total`US children 

```{r change in scores time, fig.width=12}

outcome_labels=c('Global methylation', 'Pediatric clock', 'AHHR: cg05575921', 'Polymethylation score \n (newborn, mean centered)', 'Polymethylation score  \n (older children, mean centered')
names(outcome_labels)=c('globalmethylation', 'pediatric', 'cg05575921', 'SSnewbornCT_center','SSolder_center')

fig2a=modeldata%>%
  dplyr::select(idnum, childteen, SSolder_center, SSnewbornCT_center, 
                cg05575921, globalmethylation, pediatric)%>%
  pivot_longer(cols=c(globalmethylation, pediatric, SSnewbornCT_center, SSolder_center, cg05575921),
               names_to='Methylation summary measure type',
               values_to='Methylation summary measure')%>%
  pivot_wider(names_from=childteen, 
              values_from=`Methylation summary measure`)%>%
  mutate(meth_f=factor(`Methylation summary measure type`, 
                       levels=c('SSnewbornCT_center', 'SSolder_center', 
                                'cg05575921',  'globalmethylation', 'pediatric')))%>%
  ggplot(aes(x=C, y=T))+geom_point()+stat_cor()+geom_smooth(method=lm)+theme_classic()+
  scale_x_continuous('Age 9 score')+scale_y_continuous('Age 15 score')+
  facet_wrap(~meth_f, scales='free', labeller = labeller(meth_f=outcome_labels), nrow=1)

fig2b=modeldata%>%
  dplyr::select(idnum, childteen, SSolder_center, SSnewbornCT_center, 
                cg05575921, globalmethylation, pediatric)%>%
  pivot_longer(cols=c(globalmethylation, pediatric, SSnewbornCT_center, SSolder_center, cg05575921),
               names_to='Methylation summary measure type', 
               values_to='Methylation summary measure')%>%
  pivot_wider(names_from=childteen,
              values_from=`Methylation summary measure`)%>%
  mutate(meth_f=factor(`Methylation summary measure type`, 
                       levels=c('SSnewbornCT_center', 'SSolder_center', '
                                cg05575921',  'globalmethylation', 'pediatric')),
         diff=T-C)%>%
  ggplot(aes(x=diff))+geom_histogram()+
  facet_wrap(~meth_f, scales='free_x', labeller = labeller(meth_f=outcome_labels), nrow=1)+
  theme_classic()+xlab('Difference in measure (Age 15- Age 9)')+
  geom_vline(aes(xintercept=0), color='red', linetype=2)+geom_rug()

plot_grid(fig2a, fig2b, nrow=2, align = 'v', axis = 'lr')

```


# Table 1: Bivariate associations between prenatal maternal smoking, DNA methylation summary measures and important covariates among a diverse sample of 

```{r temp relabel varables}
set_label(modeldata$cg05575921)<-'AHHR: cg05575921'
set_label(modeldata$SmkAtVisitPastmonth)<-'Past month maternal/primary caregiver smokin (pack/day)'
set_label(modeldata$PostnatalMaternalSmokingAny)<-'Any maternal postnatal smoking when child 1 and 5 years of age'
modeldata$childteen=factor(case_when(modeldata$childteen=='C'~'Age 9', 
                              modeldata$childteen=='T'~'Age 15'), levels=c('Age 9', 'Age 15'))
```


```{r bivariate table}
export2md(strataTable(createTable(compareGroups(smkPreg_binary~globalmethylation+pediatric+SSnewbornCT_center+cg05575921+Epi+Fib+IC+ChildAgeComposite+cm1inpov+ancestry+cm1bsex+m1g2_YesNoPreg+m1g3_YesNoPreg+PostnatalMaternalSmokingAny+SmkAtVisitPastmonth, data=modeldata)), 'childteen'))
```


#Supplemental Table XX - Bivariate associations between prenatal maternal smoking and covariates in ancestry strata



# Supplemental Table XX: Associations between prenatal maternal smoking and DNA methylation summary measures in multivariable models among `r n_total` US children

```{r}
my_main_outcomes=c('AHHR: cg05575921', 'Sustained smoking polymethylation score (newborns, cell-type controlled)', 'Sustained smoking polymethylation score (older children)', 'Pediatric clock', 'Global methylation')

my_names=c('Methylation measure', paste0(c(paste(c('Age 9 model \n n=', 'Age 15 model \n n='), modeldata%>%group_by(childteen)%>%summarise(n=n())%>%pull(n)), paste0('Longitudinal models <br> n=', n_total)), '<br> Beta (95% CI); p-value'))

tb2=rbind(global_models, longitudinal_global_models %>% mutate(childteen='Longitudinal'))%>%filter(predictors=='secondhand smoke exposure model')%>%filter(outcome %in% my_main_outcomes)%>%unnest(tidied)%>%filter(term=='smkPreg_binaryYes')%>%mutate(estimate=paste0(my_round(estimate, 2), ' (', my_round(conf.low, 2), ', ', my_round(conf.high, 2), '); ', signif(p.value, 2)))%>%dplyr::select(childteen, outcome, estimate)%>%pivot_wider(names_from=childteen, values_from=c(estimate))
names(tb2)=my_names

tb2%>%kable(., escape=F)%>%kable_minimal()%>%
  kableExtra::scroll_box(width = "100%")%>% footnote(general = "All models adjusted for:child sex, mother income to poverty ratio at birth, epithelial and immune cell proportions (estimated from methylation data), maternal other drug and other alcohol use during pregnancy, batch of array, genetic ancestry (1st two principal components of genetic data), postnatal smoke exposure (any postnatal maternal smoking and maternal packs per day in month prior to visit).")%>%kable_styling(font_size = 10)
```

```{r, width=11}
#alternatively 
my_names=c('Methylation measure', paste0(c(paste0(paste0('Unstratified <br> n=', n_total), footnote_marker_alphabet(1, 'html')), paste0(modeldata%>%group_by(ancestry)%>%dplyr::select(ancestry, idnum)%>%unique()%>%summarise(n=n())%>%transmute(label=paste0(ancestry, ' <br> n=', n))%>%pull(label), footnote_marker_alphabet(2, 'html'))), '<br> Beta (95% CI); p-value'))

tb2=rbind(longitudinal_global_models %>% mutate(ancestry='Unstratified'), longitudinal_local_models%>%dplyr::select(-data))%>%filter(predictors=='secondhand smoke exposure model')%>%filter(outcome %in% my_main_outcomes)%>%unnest(tidied)%>%filter(term=='smkPreg_binaryYes')%>%mutate(estimate=paste0(my_round(estimate, 2), ' (', my_round(conf.low, 2), ', ', my_round(conf.high, 2), ') p=', signif(p.value, 2)))%>%dplyr::select(ancestry, outcome, estimate)%>%pivot_wider(names_from=ancestry, values_from=c(estimate))

names(tb2)=my_names

tb2%>%kable(., escape=F)%>%kable_minimal()%>%
  kableExtra::scroll_box(width = "100%")%>% footnote(alphabet =  c("Model adjusted for:child sex, mother income to poverty ratio at birth, epithelial and immune cell proportions (estimated from methylation data), maternal other drug and other alcohol use during pregnancy, batch of array, genetic ancestry (1st two principal components of genetic data), postnatal smoke exposure (any postnatal maternal smoking and maternal packs per day in month prior to visit).", "Models adjusted as in (a) but principal components of genetic ancestry rerun within ancestry strata and first two components from these stratified principal components analyses used"))%>%kable_styling(font_size = 10)

```


# Figure 3 - Polymethylation scores are associated with prenatal maternal smoke exposure consistently across age and ancestry group in a sample of `r n_total` US children

```{r, fig.width=12}
my_outcomes=c('Global methylation', 'Pediatric clock', 'AHHR: cg05575921', 'Sustained smoking polymethylation score (newborns, cell-type controlled)')

outcome_labels=c('Global methylation', 'Pediatric clock', 'AHHR: cg05575921',  'Polymethylation score \n (newborn, mean centered)')

all_models=rbind(local_models, global_models%>%mutate(ancestry='Unstratified'))

data_text=all_models%>%
  mutate(n=map_dbl(data, nrow), n=paste0('n=', n), x=-0.25)%>%
  unnest(tidied)%>%
  filter(outcome=='Sustained smoking polymethylation score (newborns, cell-type controlled)' & term=='smkPreg_binaryYes'& predictors=='secondhand smoke exposure model')%>%mutate(outcome_f=outcome)
  
names(outcome_labels)=my_outcomes

all_models%>%
  mutate(n=map_dbl(data, nrow), n=paste0('n=', n))%>%
  unnest(tidied)%>%
  filter(term=='smkPreg_binaryYes' & predictors=='secondhand smoke exposure model')%>%
  filter(outcome%in% my_outcomes)%>%
    mutate(outcome_f=factor(outcome, levels=rev(my_outcomes)))%>%
  ggplot(aes(x=estimate, xmin=conf.low, xmax=conf.high, color=factor(age, rev(levels(age))), y=ancestry))+
  geom_point(position = position_dodge(width = 1))+
  geom_errorbarh(height=0.1, position = position_dodge(width = 1))+
  facet_grid(.~outcome_f, scales='free_x', labeller = labeller(outcome_f=outcome_labels))+
  geom_vline(xintercept=0, color='red', linetype="dashed", alpha=0.5)+
  geom_text(data=data_text, aes(x=x,label=n), position=position_dodge(width = 1), hjust=0.05)+
  theme_classic()+
  theme(text = element_text(size=16))+theme(legend.position = 'bottom')+
  scale_color_discrete('', limits=c('Age 9', 'Age 15'))+
  scale_x_continuous('Coefficient for prenatal maternal smoking + 95% CI')+
  scale_y_discrete('', limits=c('European ancestry', 'Hispanic ancestry', 'African ancestry', 'Unstratified'))+scale_color_manual('', values=c('black', 'darkgrey'))
```


# Supplemental Figure XX: Surrogate variable associations with known covariates

# Supplemental Table XX: Surrogate variable models 

# Figure 4 - Polymethylation scores more accurately delineate prenatal smoke exposure status than non-targeted DNA methylation summary measures and *a priori* CpGs 

```{r, fig.width=10}

names(my_outcomes)=c( 'globalmethylation', 'pediatric','cg05575921', 'SSnewbornCT_center')
my_outcomes=c('Global methylation', 'Pediatric clock', "AHHR: cg05575921", 'Polymethylation score \n (newborn, mean centered)')

fig4a= global_roc%>%
  dplyr::select(predictors, covariates, methylation, childteen, test)%>%
  mutate(modeltype=ifelse(methylation=='', 'Base model', paste0('Base model+', methylation)))%>%
  unnest(test) %>% 
  filter(str_detect(methylation, 'SSnewbornCT|SSolder|cg055|global|pediatric'))%>%
  ggplot(aes(x=spec, y=sens, color=modeltype))+geom_line()+
  facet_wrap(childteen~., labeller=labeller(childteen=age_labels), nrow=1)+
  scale_color_discrete('', labels=my_outcomes)+
  theme_classic()+theme(legend.position = 'right')+guides(color=guide_legend(nrow=2, byrow=TRUE))+
  geom_abline(intercept=1, slope=-1, color='black')+
  xlab('Specificity')+ylab('Sensitivity')+
  theme(legend.position='bottom')+ coord_fixed()

fig4b=global_roc%>%
  dplyr::select(covariates, methylation, childteen, test)%>%unnest(test) %>% 
  filter(str_detect(methylation, 'SSnewbornCT') 
         & covariates=='')%>%
  rbind(long_global_roc%>% 
          mutate(childteen='C+T', methylation=gsub('_C.*', '', methylation))%>%
          dplyr::select(covariates, methylation, childteen, test)%>%
          unnest(test) %>% 
          filter(str_detect(methylation, 'SSnewbornCT') 
                 & covariates==''))%>%
  ggplot(aes(x=spec, y=sens, color=childteen, linetype=childteen))+geom_line(size=2)+
  facet_wrap(~methylation, labeller = labeller(methylation=c('SSnewbornCT_center'='Polymethylation score, \n newborn mean centered')))+
  scale_color_discrete(labels=my_outcomes)+
  theme_classic()+theme(legend.position = 'right')+guides(color=guide_legend(nrow=2,byrow=TRUE))+
  geom_abline(intercept=1, slope=-1, color='black')+
  scale_color_grey('', labels=c('Age 9 only', 'Age 9 & 15', 'Age 15 only'))+
  scale_linetype('', labels=c('Age 9 only', 'Age 9 & 15', 'Age 15 only'))+
  xlab('Specificity')+ylab('Sensitivity')+
  theme(legend.position='bottom')+ coord_fixed()

cowplot::plot_grid(fig4a, fig4b, labels=c('A', 'B'), nrow=1, rel_widths=c(0.65, 0.35), align='h', axis='t')


```

add p value comparing base model to adding in curves 

# Question for group: add EWAS results to this paper

- Arguments in favor: recent paper in Clinical Epigenetics included both 
- Arguments against: enough here for a compellling story; deadline of December 1st; submit and if asked for we have it available. 

# Cross sectional EWAS results: 

# Longitudinal EWAS results 

# METAL meta-analysis of 450K + EPIC chip data